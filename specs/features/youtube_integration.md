# 特徴仕様: YouTube アカウント連携とデータ取得

## 概要
配信者が自身の YouTube チャンネルを登録し、システムがそのチャンネルの最新情報（ライブステータス、最新動画など）を低コストで取得・表示する仕組みを定義します。

## アーキテクチャ構成
「コストをかけない」という要件を実現するため、以下の 3 層構造で設計します。

### 1. 親アプリ (管理側): YouTube チャンネル登録
- **機能**: ユーザー（配信者）が自身のチャンネル ID をプロフィールに保存します。
- **コスト抑制**: 
  - OAuth 認証は行わず、まずはパブリックなチャンネル ID または URL の登録のみで開始。
  - 登録時に 1 回だけチャンネル情報を取得し、アイコンや名称を `profiles` テーブルにキャッシュします。

### 2. バックエンド: 定期バッチ更新 (後日実装)
- **機能**: GitHub Actions または Vercel Cron を使用。
- **コスト抑制**: 
  - 全ユーザーのチャンネル状態を一括でチェック（1日2〜4回程度）。
  - Data API のクォータ消費を「リスト取得」で最小化。
  - ライブ配信開始・終了を検知し、DB の `status` を更新。

### 3. 子アプリ (公開側): 効率的なデータ表示
- **機能**: `/[username]` ページでキャッシュされたデータを表示。
- **コスト抑制**:
  - **ISR (Incremental Static Regeneration)** を活用。
  - ユーザーがアクセスするたびに YouTube API を叩くのではなく、DB から情報を読み取る。
  - ISR の再検証間隔（`revalidate`）を 5 分〜15 分程度に設定し、DB 負荷も分散。

## データ連携項目
- `profiles.youtube_channel_id`
- `profiles.youtube_handle` (ハンドル名)
- `items.youtube_video_id` (判別用)

## 今後の拡張性 (Phase 2+)
- **YouTube Data API 連携**: 公開 API を使った自動動画追加。
- **WebSub (PubSubHubbub)**: Google からのプッシュ通知を受け取り、完全リアルタイム更新（API 費用ゼロ）。
